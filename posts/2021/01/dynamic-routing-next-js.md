---
title: "[Next.js] recursive algorithm for getting all static paths"
description: "‡∏°‡∏≤‡∏ó‡∏≥ dynamic routing ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö blog ‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡∏Å content ‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞"
date: "2021-01-02"
---

# Introduction

‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô blog ‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡∏Ñ‡∏ô ‡∏Ñ‡∏á‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ content ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ö‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏î‡∏π‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á‡πÑ‡∏î‡πâ 
‡πÄ‡∏•‡∏¢‡∏à‡∏∞‡πÅ‡∏¢‡∏Å‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏™‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÜ ‡πÄ‡∏ä‡πà‡∏ô `2020/01`, `2020/02`, ..., `2021/01`  ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏™‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß 

‡πÉ‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡∏à‡∏∞‡∏°‡∏≤‡∏™‡∏≠‡∏ô setup routing ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö ‡πÅ‡∏•‡∏∞‡πÇ‡∏û‡∏™‡∏ï‡πà‡∏≤‡∏á‡πÜ‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡πÑ‡∏î‡πâ‡∏ú‡πà‡∏≤‡∏ô URL ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö `mysite.com/posts/2021/01/dynamic-routing-next-js` 

# ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Å‡∏±‡∏ö dynamic routing

## Static routing

‡πÉ‡∏ô Next.js ‡∏à‡∏∞‡∏°‡∏µ‡∏Å‡∏≤‡∏£ routing ‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå pages ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ ‡πÄ‡∏ä‡πà‡∏ô‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå `pages/about-me.js` ‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô route `/about-me`

## Dynamic routing

‡∏ô‡∏≠‡∏Å‡∏à‡∏≤‡∏Å static routing ‡πÅ‡∏•‡πâ‡∏ß Next.js ‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå dynamic routing ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ generate route ‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡πÑ‡∏î‡πâ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô

‡πÉ‡∏ô tutorial ‡∏Ç‡∏≠‡∏á Next.js ‡∏Å‡πá‡∏à‡∏∞[‡∏™‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ blog](https://nextjs.org/learn/basics/create-nextjs-app) ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ dynamic routing ‡πÇ‡∏î‡∏¢

‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö content ‡∏Ç‡∏≠‡∏á blog ‡∏Å‡πá‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏≠‡∏≤‡∏°‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö ‡πÄ‡∏ä‡πà‡∏ô

- `posts/ssg-ssr.md` --> path `/posts/ssg-ssr`
- `posts/ssg-ssr.md` --> path `/posts/ssg-ssr`

‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏õ‡πá‡∏ô pattern `/posts/:id` ‡∏ô‡∏±‡πà‡∏ô‡πÄ‡∏≠‡∏á

‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏≤ define dynamic route ‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå `pages/posts/[id].js`

(‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö routing ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ follow ‡∏ï‡∏±‡∏ß tutorial ‡πÑ‡∏î‡πâ[‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà](https://nextjs.org/learn/basics/dynamic-routes))

### Catch all paths

‡∏û‡∏£‡∏∞‡πÄ‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏á‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏•‡∏¢‡∏Å‡πá‡∏Ñ‡∏∑‡∏≠ catch all paths ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô dynamic routing ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ô‡∏∂‡∏á ‡∏ã‡∏∂‡πà‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ match ‡∏´‡∏•‡∏≤‡∏¢‡πÜ route segments ‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö `/posts/*id` ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞ match path `/posts/foo`, `/posts/foo/bar`, `/posts/foo/bar/baz ` (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ match ‡∏´‡∏•‡∏≤‡∏¢‡πÜ segments ‡πÑ‡∏î‡πâ) ‡πÇ‡∏î‡∏¢‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ match path ‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ó‡∏≥‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `posts/pages/[...id].js` (‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏∞‡∏°‡∏µ‡∏à‡∏∏‡∏î 3 ‡∏à‡∏∏‡∏î)

‡∏ã‡∏∂‡πà‡∏á‡∏Å‡πá‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ match path ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö `/posts/2020/01/post-1`
`/posts/2020/02/post-2` ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£

# Let's implement it!

‡∏û‡∏π‡∏î‡∏°‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ô‡∏≤‡∏ô ‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏° implement ‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞

> Note: code ‡πÉ‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞ base-on ‡∏ï‡∏±‡∏ß tutorial ‡∏Ç‡∏≠‡∏á Next.js

‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏´‡πâ blog ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ï‡πâ path `/posts` ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏ä‡πà‡∏ô `/posts/2021/01/next-js-tutorial`)
‡πÅ‡∏•‡∏∞‡πÄ‡∏£‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡∏à‡∏∞ content ‡∏Ç‡∏≠‡∏á blog ‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå markdown ‡πÑ‡∏ß‡πâ‡πÉ‡∏ï‡πâ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå posts ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô[‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ](https://nextjs.org/learn/basics/data-fetching/blog-data) ‡πÉ‡∏ô Next.js tutorial)

## Overview
‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÜ‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏ñ‡∏∂‡∏á‡πÉ‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠

- `pages/posts/[...id].js` ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô dynamic path ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏ó‡∏≥ routing 
- ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `posts` ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå markdown ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤
- ‡πÑ‡∏ü‡∏•‡πå `lib/pages.js` ‡πÄ‡∏Å‡πá‡∏ö‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `pages` ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÉ‡∏´‡πâ `getStaticPaths` ‡πÅ‡∏•‡∏∞ `getStaticProps` ‡πÉ‡∏ô `pages/posts/[...id].js` (‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï) ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ

## Set up dynamic route

‡∏Å‡πà‡∏≠‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏£‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `pages/posts/[...id].js` ‡∏Å‡πà‡∏≠‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á dynamic path `/posts/*id`
‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡∏≤ ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ

```javascript
// file: pages/posts/[...id].js
import { getAllPostIds, getPostData } from "../../lib/posts";

export async function getStaticProps({ params }) {
  const postData = await getPostData(params.id);
  return {
    props: {
      postData,
    },
  };
}

export default function Post({ postData }) {
  return (
    <div>
      <h1>{postData.title}</h1>
      <div>{postData.id}</div>
      <div>{postData.date} </div>
      <hr />
      <div dangerouslySetInnerHTML={{ __html: postData.contentHtml }} />
    </div>
  );
}

export async function getStaticPaths() {
  const paths = getAllPostIds();
  return {
    paths,
    fallback: false,
  };
}
```

## Implement function for `getStaticPaths`

Next.js ‡∏à‡∏∞‡πÉ‡∏ä‡πâ path ‡∏à‡∏≤‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getStaticPaths` ‡πÄ‡∏û‡∏∑‡πà‡∏≠ generate page ‡πÑ‡∏ß‡πâ‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤ (Static Site Generation -- SSG) 

‡πÇ‡∏î‡∏¢‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏´‡πâ `getStaticPaths` ‡∏à‡∏∞‡πÑ‡∏õ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `getAllPostIds` ‡πÉ‡∏ô `lib/posts.js` ‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ

>  ‡πÉ‡∏ô `lib/posts.js` ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å file system ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ code ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ



## Algorithm from getting markdown files <a name="foo" href="#foo">üîó</a>

‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ï‡∏≤‡∏° tutorial ‡∏ó‡∏µ‡πà‡πÅ‡∏Ñ‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ list ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `pages` ‡πÑ‡∏î‡πâ
‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå pages ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÅ‡∏ï‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢‡πÜ (‡πÄ‡∏ä‡πà‡∏ô `2020/01, 2020/02, ...`)

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ list ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå markdown ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢‡πÜ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏î‡πâ
```js
// file: lib/posts.js
import fs from "fs";
import path from "path";
import matter from "gray-matter";
import remark from "remark";
import html from "remark-html";

function parseFile(path) {
  const fileContents = fs.readFileSync(path, "utf-8");
  const matterResult = matter(fileContents);

  return {
    ...matterResult.data,
  };
}

function isDir(path) {
  return !/\.md$/.test(path);
}

function getPostInDirRecur(dirname) {
  const filenames = fs.readdirSync(dirname);

  const allPostData = [];
  for (let filename of filenames) {
    if (isDir(filename)) {
      const subDirPosts = getPostInDirRecur(path.join(dirname, filename));
      const subDirPostsWithPrefix = subDirPosts.map((post) => {
        return {
          ...post, // original data
          id: [filename, ...post.id], // prefix id with dirname
        };
      });
      allPostData.push(...subDirPostsWithPrefix);
    } else {
      const id = filename.replace(/\.md$/, "");
      const fullpath = path.join(dirname, filename);
      allPostData.push({
        id: [id],
        ...parseFile(fullpath),
      });
    }
  }
  return allPostData;
}
```

‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getAllPostIds` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ `getStaticPaths` ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡πÉ‡∏ô `pages/posts/[...id].js` ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å

> `getAllPostIds` ‡∏à‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏Å `getPostInDirRecur` ‡∏ó‡∏µ‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `pages` ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ü‡∏•‡πå markdown 

```js
// file: lib/posts.js
const postsDirectory = path.join(process.cwd(), "posts");

export function getAllPostIds() {
  const allPostsRecur = getPostInDirRecur(postsDirectory);

  // console.log(allPostsRecur)
  return allPostsRecur.map((post) => {
    return {
      params: {
        id: post.id,
      },
    };
  });
}
```

‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getPostInDirRecur` ‡∏à‡∏∞‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ traverse ‡πÑ‡∏õ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢‡πÜ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠ list ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå markdown ‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

‡∏´‡∏≤‡∏Å‡∏•‡∏≠‡∏á‡πÄ‡∏≠‡∏≤‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡∏Å‡∏•‡πà‡∏≤‡∏ß‡πÑ‡∏õ‡∏°‡∏≤‡∏•‡∏≠‡∏á‡∏£‡∏±‡∏ô‡∏Å‡πá‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ô‡∏µ‡πâ
![foo](/images/2021/01/dynamic-routing-next-js/recur-result.png)

## How it works

‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getPostInDirRecur(dirname)` ‡∏ã‡∏∂‡πà‡∏á‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö [recursive](https://www.geeksforgeeks.org/recursive-functions/)

1. ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏ô `dirname`
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ `result` ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ markdown ‡πÉ‡∏ï‡πâ `dirname` ‡∏ô‡∏µ‡πâ
3. ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á `dirname`

- ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πá‡πÄ‡∏≠‡∏≤‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô list `result` ‡πÄ‡∏•‡∏¢
  - ‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏ß‡πà‡∏≤ path ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤ return ‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô array ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ path ‡πÅ‡∏ö‡∏ö catch all ‡∏ï‡∏£‡∏á id ‡∏ó‡∏µ‡πà return ‡∏°‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô array
- ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Å‡πá‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getPostInDirRecur` ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå markdown ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢‡∏ô‡∏±‡πâ‡∏ô‡πÜ‡∏ï‡πà‡∏≠‡∏≠‡∏µ‡∏Å
  - ‡πÅ‡∏ï‡πà‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏≠‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô list result ‡∏Å‡πá‡πÄ‡∏≠‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢ (01) ‡∏ô‡∏±‡πâ‡∏ô ‡πÑ‡∏õ‡πÅ‡∏ó‡∏£‡∏Å‡∏´‡∏ô‡πâ‡∏≤ id

> ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ä‡πà‡∏ô
>
> - ‡∏™‡∏°‡∏°‡∏ï‡∏¥‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getPostInDirRecur` ‡∏ó‡∏µ‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå 2021 ‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏à‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢ 01
> - ‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô `getPostInDirRecur` ‡∏Å‡∏±‡∏ö‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå 01 ‡πÄ‡∏û‡∏∑‡πà‡∏≠ list ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ï‡πâ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå 01 ‡∏Å‡πà‡∏≠‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏≠‡∏≠‡∏Å‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà return ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡πÇ‡∏´‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå 01 ‡∏ô‡∏±‡πâ‡∏ô‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ä‡∏∑‡πà‡∏≠ `dynamic-routing-next-js` ‡∏Å‡∏±‡∏ö `welcome` ‡∏≠‡∏¢‡∏π‡πà

```js
[{ id: ["dynamic-routing-next-js"] }, { id: ["welcome"] }];
```

> - ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô return ‡∏Å‡∏•‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á getPostInDirRecur ‡∏Å‡∏±‡∏ö‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå 2021 ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ file ‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô list ‡πÉ‡∏´‡πâ ‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏¢‡πà‡∏≠‡∏¢ (01) ‡πÅ‡∏ó‡∏£‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏Ç‡πâ‡∏≤‡∏á
>   `id` ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô

```js
[{ id: ["01", "dynamic-routing-next-js"] }, { id: ["01", "welcome"] }];
```

> - ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡∏´‡∏°‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå 2021 ‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå `01/dynamic-routing-next-js` ‡πÅ‡∏•‡∏∞ `01/welcome`
> - ‡πÄ‡∏°‡∏∑‡πà‡∏≠ `getPostInDirRecur('2021')` ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πá‡∏à‡∏∞ return ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà `getPostInDir('pages')` ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏õ‡πÉ‡∏™‡πà‡πÉ‡∏ô list ‡∏Å‡πá‡∏ó‡∏≥‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∑‡∏≠‡∏à‡∏∞‡πÄ‡∏≠‡∏≤‡∏ä‡∏∑‡∏≠‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå (2021) ‡πÑ‡∏õ‡πÅ‡∏ó‡∏£‡∏Å‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤ id ‡πÄ‡∏ä‡πà‡∏ô‡∏Å‡∏±‡∏ô ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡πá‡∏ô (‡∏´‡∏≤‡∏Å‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏î‡∏π‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ `id` ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ)
```js
[{ id: ["2021", "01", "dynamic-routing-next-js"] }, { id: ["2021", "01", "welcome"] }];
```



4. ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ list file ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏Å‡πá‡∏à‡∏∞ return array ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå markdown ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ

## Implement getStaticProps

`getStaticProps` ‡πÉ‡∏ä‡πâ‡∏î‡∏∂‡∏á content ‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏´‡∏ô‡πâ‡∏≤‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á content ‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå markdown ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô `lib/posts.js`

```js
// file: Lib/posts.js
export async function getPostData(idArray) {
  idArray[idArray.length - 1] = idArray[idArray.length - 1] + ".md"; // add extension to file name
  const fullPath = path.join(postsDirectory, ...idArray);
  console.log("fullpath", fullPath);
  const fileContents = fs.readFileSync(fullPath, "utf8");

  // Use gray-matter to parse the post metadata section
  const matterResult = matter(fileContents);

  const processedContent = await remark()
    .use(html)
    .process(matterResult.content);
  const contentHtml = processedContent.toString();

  // Combine the data with the id
  return {
    id: idArray,
    contentHtml,
    ...matterResult.data,
  };
}
```
‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏´‡πâ `getStaticProps` ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `pages/posts/[...id].js` ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ
```js
// file: pages/posts/[...id].js
export async function getStaticProps({ params }) {
  const postData = await getPostData(params.id) // id is array
  return {
    props: {
      postData
    }
  }
}
```
# Test it
‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏≤‡∏ó‡∏≥‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏≤‡∏Å‡πá‡∏à‡∏∞‡∏•‡∏≠‡∏á‡πÄ‡∏ó‡∏™‡∏î‡∏π 
1. ‡∏•‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå posts ‡πÄ‡∏ä‡πà‡∏ô `2021/01/hello.md`

```markdown
---
title: 'Hello world !'
date: '2020-01-02'
---

# This is test page
```

2. ‡∏à‡∏≤‡∏Å‡∏ô‡∏±‡πâ‡∏ô‡∏•‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà `localhost:3000/posts/2021/01/hello.md` ‡∏Å‡πá‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ

![result-page](/images/2021/01/dynamic-routing-next-js/result-page.png)


# The end
